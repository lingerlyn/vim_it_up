######################
### DESIGN CHANGES ###
######################

# status line
set -g status-justify left
set -g status-bg "#282828"
set -g status on

# panes
set -g pane-border-fg "#3c3836"
set -g pane-active-border-fg "#504945"

# messaging 
set -g message-bg "#504945"
set -g message-fg "#ebdbb2"
set -g message-command-bg "#504945"
set -g message-command-fg "#ebdbb2"

# window status
setw -g window-status-fg "#a89984"
setw -g window-status-attr "none"
setw -g window-status-activity-bg "#282828"
setw -g window-status-activity-attr "none"
setw -g window-status-activity-fg "#a89984"
setw -g window-status-separator ""
setw -g window-status-bg "#3c3836"
setw -g window-status-format "#[fg=#a89984,bg=#282828] #I |#[fg=#a89984,bg=#282828] #W "
setw -g window-status-current-format "#[fg=#3c3836,bg=#282828,nobold,nounderscore,noitalics]#[fg=#ebdbb2,bg=#282828] #I |#[fg=#ebdbb2,bg=#282828] #W #[fg=#504945,bg=#282828,nobold,nounderscore,noitalics]"

# The statusbar
set -g status-attr none
set -g status-left-length "100"
set -g status-left-attr "none"
set -g status-right-attr "none"
set -g status-right-length "100"
set -g status-left "#[fg=#a89984,bg=#282828] #S #[fg=#282828,bg=#282828,nobold,nounderscore,noitalics]"
set -g status-right "#[fg=#282828,bg=#282828,nobold,nounderscore,noitalics]#[fg=#a89984,bg=#282828] %Y-%m-%d | %H:%M #[fg=#282828,bg=#282828,nobold,nounderscore,noitalics]#[fg=#a89984,bg=#282828] #h "

# loud or quiet?
set-option -g visual-activity off
set-option -g visual-bell off
set-option -g visual-silence off
set-window-option -g monitor-activity off
set-option -g bell-action none

# Set aggressive resize
setw -g aggressive-resize on

# Add truecolor support
# set -g default-terminal "screen-256color"
#set -ga terminal-overrides ",*256col*:Tc"

set -g default-terminal 'tmux-256color'
set -as terminal-overrides ',xterm*:Tc:sitm=\E[3m'

# Custom Settings { 
set -sg escape-time 0

# Increase history limit
set -g history-limit 10000

# Start windows and panes at 1, not 0
set -g base-index 1
setw -g pane-base-index 1

# use mouse mode
set -g mouse on

# remap prefix to Control + a
set -g prefix C-a
unbind C-b
bind a send-prefix

# Smart pane switching with awareness of Vim splits.
# See: https://github.com/christoomey/vim-tmux-navigator
is_vim="ps -o state= -o comm= -t '#{pane_tty}' \
    | grep -iqE '^[^TXZ ]+ +(\\S+\\/)?g?(view|n?vim?x?)(diff)?$'"
    bind-key -n C-h if-shell "$is_vim" "send-keys C-h"  "select-pane -L"
    bind-key -n C-j if-shell "$is_vim" "send-keys C-j"  "select-pane -D"
    bind-key -n C-k if-shell "$is_vim" "send-keys C-k"  "select-pane -U"
    bind-key -n C-l if-shell "$is_vim" "send-keys C-l"  "select-pane -R"
    bind-key -n C-\ if-shell "$is_vim" "send-keys C-\\" "select-pane -l"
    bind-key -T copy-mode-vi C-h select-pane -L
    bind-key -T copy-mode-vi C-j select-pane -D
    bind-key -T copy-mode-vi C-k select-pane -U
    bind-key -T copy-mode-vi C-l select-pane -R
    bind-key -T copy-mode-vi C-\ select-pane -l

# Hide status bar
bind-key h set -g status

# quick pane cycling
unbind ^A
bind ^A select-pane -t :.+

# use vim like bindings
set-window-option -g mode-keys vi

# Kill other panes
bind-key o kill-pane -a
bind-key k kill-window -a 

# use vim like splits
bind-key v split-window -h -c "#{pane_current_path}"
bind-key S split-window -v -c "#{pane_current_path}"
bind-key + select-layout main-horizontal
bind-key = select-layout main-vertical

# Nested tmux shifting with shift
bind -n M-F11 set -qg status-bg	"#282828"
bind -n M-F12 set -qg status-bg "#3c3836"

bind -n S-up \
    send-keys M-F12 \; \
    set -qg status-bg "#3c3836" \; \
    unbind -n S-left \; \
    unbind -n S-right \; \
    unbind -n S-C-left \; \
    unbind -n S-C-right \; \
    unbind -n C-t \; \
    set -qg prefix C-b

bind -n S-down \
    send-keys M-F11 \; \
    set -qg status-bg  "#282828"\; \
    bind -n S-left  prev \; \
    bind -n S-right next \; \
    bind -n S-C-left swap-window -t -1 \; \
    bind -n S-C-right swap-window -t +1 \; \
    bind -n C-t new-window -a -c "#{pane_current_path}" \; \
    set -qg prefix C-a

# Setup 'v' to begin selection as in Vim
# https://github.com/tmux/tmux/issues/754
bind-key -T edit-mode-vi Up send-keys -X history-up
bind-key -T edit-mode-vi Down send-keys -X history-down
unbind-key -T copy-mode-vi Space     ;   bind-key -T copy-mode-vi v send-keys -X begin-selection
unbind-key -T copy-mode-vi Enter     ;   bind-key -T copy-mode-vi y send-keys -X copy-pipe-and-cancel "pbcopy"
unbind-key -T copy-mode-vi C-v       ;   bind-key -T copy-mode-vi C-v send-keys -X rectangle-toggle
unbind-key -T copy-mode-vi [         ;   bind-key -T copy-mode-vi [ send-keys -X begin-selection
unbind-key -T copy-mode-vi ]         ;   bind-key -T copy-mode-vi ] send-keys -X copy-selection
tmux_conf_copy_to_os_clipboard=true

# Search tmux panes with fzf

# unbind -T copy-mode-vi MouseDragEnd1Pane
# bind -T copy-mode-vi MouseDown1Pane select-pane \;\
#   send-keys -X copy-pipe "pbcopy" \;\
#   send-keys -X clear-selection
